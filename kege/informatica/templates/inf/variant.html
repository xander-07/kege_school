{% load static %}
{% load custom_filters %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
<!--    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"-->
<!--          integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">-->
    <link rel="stylesheet" href="{% static 'variant/css/variant.css' %}">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script type="text/javascript" src="{% static 'variant/js/variant.js' %}"></script>
    <link rel="shortcut icon" type="image/png" href="{% static 'main/img/logo.ico' %}">
    <title>KЕГЭ</title>
</head>
<body>

<div id="app">
    <div class="home-wrap">
        <div class="exam" tabindex="0">
            <div class="header-wrap">
                <div class="header">
                    <div class="time-wrap">
                        <!--                        <span class="number">Вариант {{el.id}}</span>-->
                        <span class="number" id="kim">КИМ № {{ generated_task.kim }}</span>
                        <div class="wrapp-right">
                            <button class="header--btn-finish" onclick="ShowAlert()">Завершить
                                экзамен досрочно
                            </button>
                            <div id="timer" class="timer"></div>
                        </div>

                    </div>
                </div>
            </div>
            <div class="nav-wrap">
                <div class="nav">
                    <div>
                        <p class="ans">Дано ответов</p>
                        <p class="anscount"><span id="counter_answer">{{ count_answer }}</span>/{{ tasks|length }}</p>
                    </div>
                    <div class="block arrow arrow-up">
                        <p>↑</p>
                    </div>
                    <div class="navigation">
                        <ul>
                            {% for task in tasks %}
                            {% if forloop.counter == 1 %}
                            <li>
                                <button id="button-{{forloop.counter}}" class='block task-empty task-current {% if task.id in task_save_id %}task-fill{% endif %}' onclick="showElement('my-element-{{forloop.counter}}', 'my-file-{{forloop.counter}}', 'my-answer-block-{{forloop.counter}}', 'my-table-answer-block-{{forloop.counter}}', '{{task.task_type}}')">

                                    <p>
                                        {{forloop.counter}}</p>
                                </button>
                            </li>
                            {% else %}
                            <li>
                                <button id="button-{{forloop.counter}}" class="block task-empty {% if task.id in task_save_id %}task-fill{% endif %}"
                                        onclick="showElement('my-element-{{forloop.counter}}', 'my-file-{{forloop.counter}}', 'my-answer-block-{{forloop.counter}}', 'my-table-answer-block-{{forloop.counter}}', '{{task.task_type}}')">
                                    <p>
                                        {{forloop.counter}}</p>
                                </button>
                            </li>
                            {% endif %}
                            {% endfor %}
                        </ul>
                    </div>
                    <!--                    <div class="tasks">-->

                    <!--                    </div>-->
                    <div class="block arrow arrow-down">
                        <p>↓</p>
                    </div>
                </div>
            </div>
            <div class="arrow-wrap arrow-left">
                <div class="arrow-strelka">
                    <p>←</p>
                </div>
            </div>


            <div class="modal" id="popub">
                <div class="overlay"></div>
                <div class="modalBlock">
                    <div class="heading" id="header">Досрочное завершение экзамена</div>
                    <div class="text" id="ptext">
                        Вы действительно уверены, что хотите завершить экзамен?
                        В случае завершения экзамена вернуться к вводу ответов будет невозможно.

                    </div>
                    <div class="setButtons">
                        <button class="cbtn" id="finishButton">Да</button>
                        <button class="cbtn" onclick="HideAlert()">Нет</button>
                    </div>
                </div>
            </div>

            <div class="task-wrap">
                {% for task in tasks %}
                {% if forloop.counter == 1 %}
                <div class="task" id="my-element-{{forloop.counter}}" style="display: block;">
                    <div class="text">
                        <div class="text-bolder">
                            Задание {{forloop.counter}} <span>(#{{task.id}})</span>
                        </div>
                        {{task.questions|safe}}
                    </div>
                </div>

                {% if task.task_type == 17 or task.task_type == 18 or task.task_type == 20 or task.task_type == 26 or task.task_type == 27 %}
                <div data-v-4efd0adf="" class="table-wrap" style="display: block;"
                     id="my-table-answer-block-{{forloop.counter}}">
                    <div data-v-0336fe23="" data-v-4efd0adf="" class="table-input">
                        <div data-v-0336fe23="" class="instruction"><p data-v-0336fe23="">Введите или скопируйте свой
                            ответ в поля таблицы</p></div>
                        <div data-v-0336fe23="" class="table-border">
                            <div data-v-0336fe23="">
                                <table data-v-0336fe23="">
                                    <tr data-v-0336fe23="">
                                        <td data-v-0336fe23="" class="border"></td>
                                        <td data-v-0336fe23="" class="border">1</td>
                                        <td data-v-0336fe23="" class="border">2</td>
                                    </tr>
                                    <tr data-v-0336fe23="">
                                        <td data-v-0336fe23="" class="border border-col">1</td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-1-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-2-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                    </tr>
                                </table>
                            </div>
                            <div data-v-0336fe23="" class="buttons"><input data-v-0336fe23="" type="button"
                                                                           class="delete" value="Очистить"><input
                                    data-v-0336fe23="" type="button" class="save" value="Сохранить ответ"
                            data-counter="{{ forloop.counter }}" data-id_kim="{{ generated_task.id }}"
                               data-kim="{{ generated_task.kim }}" data-id-task="{{ task.id }}"
                               data-csrf="{{ csrf_token }}" data-type="{{task.task_type}}" onclick="saveAnswer_table(this)">
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}

                {% if task.task_type == 25 %}
                <div data-v-4efd0adf="" class="table-wrap" style="display: block;"
                     id="my-table-answer-block-{{forloop.counter}}">
                    <div data-v-0336fe23="" data-v-4efd0adf="" class="table-input">
                        <div data-v-0336fe23="" class="instruction"><p data-v-0336fe23="">Введите или скопируйте свой
                            ответ в поля таблицы</p></div>
                        <div data-v-0336fe23="" class="table-border">
                            <div data-v-0336fe23="">
                                <table data-v-0336fe23="">
                                    <tr data-v-0336fe23="">
                                        <td data-v-0336fe23="" class="border"></td>
                                        <td data-v-0336fe23="" class="border">1</td>
                                        <td data-v-0336fe23="" class="border">2</td>
                                    </tr>
                                    <tr data-v-0336fe23="">
                                        <td data-v-0336fe23="" class="border border-col">1</td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-1-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-2-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                    </tr>
                                    <tr data-v-0336fe23="">
                                        <td data-v-0336fe23="" class="border border-col">2</td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-3-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-4-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                    </tr>
                                    <tr data-v-0336fe23="">
                                        <td data-v-0336fe23="" class="border border-col">3</td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-5-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-6-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                    </tr>
                                    <tr data-v-0336fe23="">
                                        <td data-v-0336fe23="" class="border border-col">4</td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-7-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-8-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                    </tr>
                                    <tr data-v-0336fe23="">
                                        <td data-v-0336fe23="" class="border border-col">5</td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-9-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-10-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                    </tr>
                                    <tr data-v-0336fe23="">
                                        <td data-v-0336fe23="" class="border border-col">6</td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-11-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-12-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                    </tr>
                                    <tr data-v-0336fe23="">
                                        <td data-v-0336fe23="" class="border border-col">7</td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-13-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-14-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                    </tr>
                                    <tr data-v-0336fe23="">
                                        <td data-v-0336fe23="" class="border border-col">8</td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-15-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-16-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                    </tr>
                                    <tr data-v-0336fe23="">
                                        <td data-v-0336fe23="" class="border border-col">9</td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-17-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-18-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                    </tr>
                                    <tr data-v-0336fe23="">
                                        <td data-v-0336fe23="" class="border border-col">10</td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-19-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-20-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                    </tr>

                                </table>
                            </div>
                            <div data-v-0336fe23="" class="buttons"><input data-v-0336fe23="" type="button"
                                                                           class="delete" value="Очистить">
                                <input
                                    data-v-0336fe23="" type="button" class="save" value="Сохранить ответ"
                                    data-counter="{{ forloop.counter }}" data-id_kim="{{ generated_task.id }}"
                                    data-kim="{{ generated_task.kim }}" data-id-task="{{ task.id }}"
                                    data-csrf="{{ csrf_token }}" data-type="{{task.task_type}}" onclick="saveAnswer_table(this)">
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}

                {% else %}
                <div class="task" id="my-element-{{forloop.counter}}" style="display: none;">
                    <div class="text">
                        <div class="text-bolder">
                            Задание {{forloop.counter}} <span>(#{{task.id}})</span>
                        </div>
                        {{task.questions|safe}}
                    </div>
                </div>

                {% if task.task_type == 17 or task.task_type == 18 or task.task_type == 20 or task.task_type == 26 or task.task_type == 27 %}
                <div data-v-4efd0adf="" class="table-wrap" style="display: none;"
                     id="my-table-answer-block-{{forloop.counter}}">
                    <div data-v-0336fe23="" data-v-4efd0adf="" class="table-input">
                        <div data-v-0336fe23="" class="instruction"><p data-v-0336fe23="">Введите или скопируйте свой
                            ответ в поля таблицы</p></div>
                        <div data-v-0336fe23="" class="table-border">
                            <div data-v-0336fe23="">
                                <table data-v-0336fe23="">
                                    <tr data-v-0336fe23="">
                                        <td data-v-0336fe23="" class="border"></td>
                                        <td data-v-0336fe23="" class="border">1</td>
                                        <td data-v-0336fe23="" class="border">2</td>
                                    </tr>
                                    <tr data-v-0336fe23="">
                                        <td data-v-0336fe23="" class="border border-col">1</td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-1-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-2-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                    </tr>
                                </table>
                            </div>
                            <div data-v-0336fe23="" class="buttons"><input data-v-0336fe23="" type="button"
                                                                           class="delete" value="Очистить">
                                <input
                                    data-v-0336fe23="" type="button" class="save" value="Сохранить ответ"
                                    data-counter="{{ forloop.counter }}" data-id_kim="{{ generated_task.id }}"
                                    data-kim="{{ generated_task.kim }}" data-id-task="{{ task.id }}"
                                    data-csrf="{{ csrf_token }}" data-type="{{task.task_type}}" onclick="saveAnswer_table(this)">
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}

                {% if task.task_type == 25 %}
                <div data-v-4efd0adf="" class="table-wrap" style="display: none;"
                     id="my-table-answer-block-{{forloop.counter}}">
                    <div data-v-0336fe23="" data-v-4efd0adf="" class="table-input">
                        <div data-v-0336fe23="" class="instruction"><p data-v-0336fe23="">Введите или скопируйте свой
                            ответ в поля таблицы</p></div>
                        <div data-v-0336fe23="" class="table-border">
                            <div data-v-0336fe23="">
                                <table data-v-0336fe23="">
                                    <tr data-v-0336fe23="">
                                        <td data-v-0336fe23="" class="border"></td>
                                        <td data-v-0336fe23="" class="border">1</td>
                                        <td data-v-0336fe23="" class="border">2</td>
                                    </tr>
                                    <tr data-v-0336fe23="">
                                        <td data-v-0336fe23="" class="border border-col">1</td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-1-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-2-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                    </tr>
                                    <tr data-v-0336fe23="">
                                        <td data-v-0336fe23="" class="border border-col">2</td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-3-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-4-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                    </tr>
                                    <tr data-v-0336fe23="">
                                        <td data-v-0336fe23="" class="border border-col">3</td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-5-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-6-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                    </tr>
                                    <tr data-v-0336fe23="">
                                        <td data-v-0336fe23="" class="border border-col">4</td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-7-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-8-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                    </tr>
                                    <tr data-v-0336fe23="">
                                        <td data-v-0336fe23="" class="border border-col">5</td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-9-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-10-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                    </tr>
                                    <tr data-v-0336fe23="">
                                        <td data-v-0336fe23="" class="border border-col">6</td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-11-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-12-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                    </tr>
                                    <tr data-v-0336fe23="">
                                        <td data-v-0336fe23="" class="border border-col">7</td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-13-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-14-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                    </tr>
                                    <tr data-v-0336fe23="">
                                        <td data-v-0336fe23="" class="border border-col">8</td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-15-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-16-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                    </tr>
                                    <tr data-v-0336fe23="">
                                        <td data-v-0336fe23="" class="border border-col">9</td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-17-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-18-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                    </tr>
                                    <tr data-v-0336fe23="">
                                        <td data-v-0336fe23="" class="border border-col">10</td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-19-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                        <td data-v-0336fe23="" class="input-col"><input data-v-0336fe23="" type="text"
                                                                                        class="input" id="answer-table-20-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}"></td>
                                    </tr>

                                </table>
                            </div>
                            <div data-v-0336fe23="" class="buttons"><input data-v-0336fe23="" type="button"
                                                                           class="delete" value="Очистить">
                                <input
                                    data-v-0336fe23="" type="button" class="save" value="Сохранить ответ"
                                    data-counter="{{ forloop.counter }}" data-id_kim="{{ generated_task.id }}"
                                    data-kim="{{ generated_task.kim }}" data-id-task="{{ task.id }}"
                                    data-csrf="{{ csrf_token }}" data-type="{{task.task_type}}" onclick="saveAnswer_table(this)">
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}


                {% endif %}
                {% endfor %}
            </div>

            <div class="arrow-wrap arrow-right">
                <div class="arrow-strelka">
                    <p>→</p>
                </div>
            </div>


            <div class="footer-wrap">
                <div class="footer">
                    {% for task in tasks %}
                    {% with counter=0 %}
                    {% if forloop.counter == 1 %}
                    <div class="files" style="display: flex;" id="my-file-{{ forloop.counter }}">
                        {% if task.files_1 %}
                        <a href="{% url 'download_file' file_id=task.id %}">
                            <img src="{% static 'variant/img/dl.png' %}" alt="">
                            {{ task.files_1.name }}
                        </a>
                        {% endif %}
                    </div>
                    {% csrf_token %}
                    <div class="answer" id="my-answer-block-{{ forloop.counter }}" style="display: flex">
                        <input type="text" class="input" id="answer-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}">
                        <input type="button" class="save" value="Сохранить ответ"
                               data-counter="{{ forloop.counter }}" data-id_kim="{{ generated_task.id }}"
                               data-kim="{{ generated_task.kim }}" data-id-task="{{ task.id }}"
                               data-csrf="{{ csrf_token }}" data-type="{{task.task_type}}"
                               onclick="saveAnswer(this)">
                    </div>
                    {% else %}
                    <div class="files" style="display: none;" id="my-file-{{ forloop.counter }}">
                        {% if task.files_1 %}
                        <a href="{% url 'download_file' file_id=task.id %}">
                            <img src="{% static 'variant/img/dl.png' %}" alt="">
                            {{ task.files_1.name }}
                        </a>
                        {% endif %}
                    </div>
                    {% csrf_token %}
                    <div class="answer" id="my-answer-block-{{ forloop.counter }}" style="display: none">
                        <input type="text" class="input" id="answer-{{ forloop.counter }}" value="{% if task.id in task_save_id %}{{ answers_user|default:''|get_item:task.id }}{% endif %}">
                        <input type="button" class="save" value="Сохранить ответ"
                               data-counter="{{ forloop.counter }}" data-id_kim="{{ generated_task.id }}"
                               data-kim="{{ generated_task.kim }}" data-id-task="{{ task.id }}"
                               data-csrf="{{ csrf_token }}" data-type="{{task.task_type}}"
                               onclick="saveAnswer(this)">
                    </div>
                    {% endif %}
                    {% endwith %}
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>

</div>
</div>
</div>

<script>


</script>


<script>
    document.addEventListener('DOMContentLoaded', function () {
        var formData = new FormData();
        var kim = '{{ generated_task.kim }}';
        formData.append('kim', kim);
        formData.append('user_id', kim);
        var time_variant;
        let continueFetching = true;

        function fetchData() {
            if (!continueFetching) {
                return;
            }

            fetch('/inf/get_data/', {
                method: 'POST',
                body: JSON.stringify(Object.fromEntries(formData)),
                headers: {
                    'Content-Type': 'application/json',
                },
            })
                .then(response => response.json())
                .then(data => {
                    console.log(data);

                    time_variant = data.time_variant;

                    if (data.finish === 'yes') {
                        console.log('Finish is yes!');
                        continueFetching = false;
                        // return;
                        let redirectUrl = '/';
                        window.location.href = redirectUrl;
                    }

                    startCountdown(time_variant);

                    if (continueFetching) {
                        setTimeout(fetchData, 9070);
                    }
                })
                .catch(error => {
                    console.error('Error fetching data:', error);
                    setTimeout(fetchData, 9070);
                });
        }

        fetchData();

        function startCountdown(seconds) {
            let timerElement = document.getElementById('timer');

            function updateTimer() {
                let hours = Math.floor(seconds / 3600);
                let minutes = Math.floor((seconds % 3600) / 60);
                let remainingSeconds = seconds % 60;

                let formattedTime = `${hours}:${minutes}`;
                timerElement.textContent = formattedTime;

                if (seconds === 0) {
                    console.log('Время вышло!');
                } else {
                    seconds--;
                    setTimeout(updateTimer, 1000);
                }
            }

            updateTimer();
        }


        function finishVariant() {
            let kim = '{{ generated_task.kim }}';
            let postData = {
                'kim': kim,
                'finish': true,
            };

            // Опции для POST-запроса
            let requestOptions = {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(postData),
            };

            // Отправка POST-запроса
            fetch('/inf/get_data/', requestOptions)
                .then(response => response.json())
                .then(data => {
                    console.log('Finish variant response:', data);
                    // console.log('Finish is yes!');
                    continueFetching = false;
                    let redirectUrl = '/';
                    window.location.href = redirectUrl;
                })
                .catch(error => {
                    console.error('Error finishing variant:', error);
                    // Дополнительные действия при ошибке
                });
        }

        // Привязка функции finishVariant() к кнопке с id "finishButton"
        document.getElementById('finishButton').addEventListener('click', finishVariant);

    });


    function ShowAlert() {
        document.getElementById("popub").className = 'modal active';
    }

    // function ShowAlert2(text) {
    //     document.getElementById("popub2").className = 'modal active';
    //     document.getElementById("ptext2").textContent = text;
    //
    // }

    function HideAlert() {
        document.getElementById("popub").className = 'modal';
    }
    // Рабочий код
    // document.addEventListener('DOMContentLoaded', function() {
    //     // Найти все input с id, содержащим "answer-table-1-"
    //     var inputs = document.querySelectorAll('input[id*="answer-table-1-"]');
    //
    //     // Пройти по каждому input
    //     inputs.forEach(function(input) {
    //         // Получить значение из input и преобразовать в массив
    //         let valuesArrayString = input.value.trim(); // удаляем лишние пробелы
    //         // console.log(valuesArrayString);
    //
    //         // Проверяем, что строка не пустая перед вызовом JSON.parse
    //         if (valuesArrayString !== "") {
    //             try {
    //                 let valuesArray = JSON.parse(valuesArrayString.replace(/'/g, '"'));
    //                 console.log(valuesArray);
    //             } catch (error) {
    //                 console.error("Ошибка при парсинге JSON:", error);
    //             }
    //         } else {
    //             console.warn("Пустая строка. Пропускаем парсинг.");
    //         }
    //     });
    // });



    document.addEventListener('DOMContentLoaded', function() {
        // Функция для создания селектора на основе диапазона
        function generateInputSelector(start, end) {
            let selector = '';
            for (let i = start; i <= end; i++) {
                selector += `input[id^="answer-table-${i}-"], `;
            }
            return selector.slice(0, -2); // Убираем последнюю запятую и пробел
        }

        // Найти все input для заданных диапазонов
        var inputs = document.querySelectorAll(
            generateInputSelector(1, 24)
        );

            // Пройти по каждому input
        inputs.forEach(function(input) {
            // Получить значение из input и преобразовать в массив
            let valuesArrayString = input.value.trim(); // удаляем лишние пробелы
            console.log(valuesArrayString);

            // Получаем индекс из id input'a (например, answer-table-1, answer-table-2, ...)
            let index = parseInt(input.id.match(/\d+/)) - 1;

            // Проверяем, что строка не пустая перед вызовом JSON.parse
            if (valuesArrayString !== "") {
                try {
                    console.log("Пытаюсь распарсить:", valuesArrayString);

                    // Заменяем пустые значения после запятых на "null" и парсим JSON
                    let valuesArray = JSON.parse(valuesArrayString.replace(/,{2,}/g, ',').replace(/(^|,)(,|$)/g, ',"null",').replace(/'/g, '"'));
                    console.log(valuesArray);

                    // Проверяем, есть ли значение с соответствующим индексом в массиве
                    if (valuesArray.length > index) {
                        // Если значение равно "null", устанавливаем пустую строку
                        input.value = valuesArray[index] === "null" ? "" : valuesArray[index];
                    } else {
                        console.warn(`В массиве нет значения для индекса ${index}.`);
                    }

                } catch (error) {
                    console.error("Ошибка при парсинге JSON:", error);
                }
            } else {
                console.warn("Пустая строка. Пропускаем парсинг.");
            }
        });
    });
</script>

</body>
</html>
